# é€²éšæ¢ä»¶ç¯„ä¾‹

[![English](https://img.shields.io/badge/README-English-blue.svg)](README.md) [![ç¹é«”ä¸­æ–‡](https://img.shields.io/badge/README-ç¹é«”ä¸­æ–‡-red.svg)](README-zh.md)

æ­¤ç¯„ä¾‹å±•ç¤ºäº† go-agent æ¡†æ¶ä¸­**è¤‡é›œçš„æ¢ä»¶ç³»çµ±**ï¼Œæ¼”ç¤ºå¦‚ä½•é€éå„ªé›…çš„æ¢ä»¶æµç¨‹æ§åˆ¶ä¾†å‰µå»ºæ™ºèƒ½ã€é©æ‡‰æ€§çš„å°è©±ä»£ç†ã€‚é€éå…¨é¢çš„ç”¨æˆ¶å…¥é–€å ´æ™¯ï¼Œæ‚¨å°‡å­¸ç¿’ä»¥ç°¡æ½”ã€å¯è®€çš„ç¨‹å¼ç¢¼å¯¦ç¾è¤‡é›œçš„è¡Œç‚ºæ¨¡å¼ã€‚

## ğŸ¯ æ­¤ç¯„ä¾‹æ¼”ç¤ºçš„å…§å®¹

æ­¤ç¯„ä¾‹å¯¦ç¾äº†ä¸€å€‹**æ™ºèƒ½å…¥é–€ä»£ç†**ï¼Œæ”¶é›†ç”¨æˆ¶è³‡è¨Šï¼ˆå§“åã€é›»å­éƒµä»¶ã€é›»è©±ã€åå¥½ï¼‰ï¼Œä¸¦å±•ç¤ºï¼š

- **ğŸ”„ ç°¡å–®æ¬„ä½æ¢ä»¶** - è‡ªå‹•æç¤ºç¼ºå¤±è³‡è¨Š
- **ğŸ§  çµ„åˆé‚è¼¯** - AND/OR/NOT æ¢ä»¶çµ„åˆ  
- **â±ï¸ å°è©±ç®¡ç†** - åŸºæ–¼è¨Šæ¯æ•¸é‡å’Œæ™‚é–“çš„è§¸ç™¼å™¨
- **ğŸ’­ å…§å®¹è­˜åˆ¥** - é—œéµå­—å’ŒçŸ­èªæª¢æ¸¬
- **ğŸ• æ™‚é–“æ„ŸçŸ¥è¡Œç‚º** - ç‡Ÿæ¥­æ™‚é–“å’Œé€±æœ«é©æ‡‰
- **ğŸ˜¤ æƒ…ç·’æ™ºèƒ½** - æŒ«æŠ˜æ„Ÿå’Œå›°é›£æª¢æ¸¬
- **ğŸ“Š çµæ§‹åŒ–è¼¸å‡º** - å®Œæ•´çš„ç”¨æˆ¶æª”æ¡ˆ JSON
- **ğŸ› ï¸ å‡½æ•¸å¼å·¥å…·** - è³‡è¨Šæ”¶é›†å’Œé©—è­‰

## ğŸ—ï¸ å±•ç¤ºçš„æ ¸å¿ƒåŠŸèƒ½

### 1. ç°¡å–®æ¬„ä½æ¢ä»¶
```go
OnMissingInfo("name").Ask("æ‚¨å¥½ï¼æˆ‘å¾ˆæ¨‚æ„å¹«åŠ©æ‚¨é–‹å§‹ã€‚è«‹å•æ‚¨çš„å§“åæ˜¯ï¼Ÿ").Build().
OnMissingInfo("email").Ask("å¾ˆå¥½ï¼ç¾åœ¨æˆ‘éœ€è¦æ‚¨çš„é›»å­éƒµä»¶åœ°å€ä¾†è¨­å®šå¸³æˆ¶ã€‚").Build().
```
è‡ªå‹•æª¢æ¸¬ç¼ºå¤±çš„å¿…å¡«æ¬„ä½ä¸¦é©ç•¶æç¤ºç”¨æˆ¶ã€‚

### 2. é‚è¼¯é‹ç®—å­çµ„åˆæ¢ä»¶
```go
When(agent.And(
    agent.WhenMissingFields("email"),
    agent.WhenMissingFields("phone"),
)).Ask("æˆ‘éœ€è¦æ‚¨çš„é›»å­éƒµä»¶åœ°å€å’Œé›»è©±è™Ÿç¢¼æ‰èƒ½ç¹¼çºŒã€‚").Build().

When(agent.Or(
    agent.WhenContains("frustrated"),
    agent.WhenContains("difficult"),
    agent.WhenMessageCount(8),
)).Ask("è®“æˆ‘å¹«æ‚¨ç°¡åŒ–é€™å€‹æµç¨‹ï¼").Build().
```
ä½¿ç”¨é‚è¼¯é‹ç®—å­çµ„åˆå¤šå€‹æ¢ä»¶ä»¥å¯¦ç¾è¤‡é›œè¡Œç‚ºã€‚

### 3. å°è©±ç®¡ç†
```go
OnMessageCount(6).Summarize().Build().
OnMessageCount(10).Ask("æˆ‘å€‘å·²ç¶“èŠäº†ä¸€æ®µæ™‚é–“ï¼è®“æˆ‘ä¾†å¹«æ‚¨ç¸½çµ...").Build().
```
é€éæä¾›æ‘˜è¦å’ŒæŒ‡å°ä¾†ç®¡ç†é•·å°è©±ã€‚

### 4. åŸºæ–¼å…§å®¹çš„è§¸ç™¼å™¨
```go
When(agent.WhenContains("help")).Ask("ç•¶ç„¶ï¼æˆ‘è©²å¦‚ä½•å¹«åŠ©æ‚¨ï¼Ÿ").Build().
When(agent.WhenContains("skip")).Ask("æ‰€æœ‰è³‡è¨Šéƒ½æ˜¯å¿…éœ€çš„ï¼Œä½†è®“æˆ‘å€‘ä¸€èµ·å®Œæˆï¼").Build().
```
æ™ºèƒ½å›æ‡‰ç‰¹å®šé—œéµå­—å’Œç”¨æˆ¶æƒ…ç·’ã€‚

### 5. æ™‚é–“æ„ŸçŸ¥è¡Œç‚º
```go
When(agent.WhenFunc("business_hours", func(session agent.Session) bool {
    now := time.Now()
    hour := now.Hour()
    return hour >= 9 && hour <= 17
})).Ask("å› ç‚ºç¾åœ¨æ˜¯ç‡Ÿæ¥­æ™‚é–“ï¼Œæˆ‘å¯ä»¥æä¾›å³æ™‚å”åŠ©ï¼").Build().
```
åŸºæ–¼æ™‚é–“ã€å·¥ä½œæ—¥æˆ–å…¶ä»–æ™‚é–“å› ç´ èª¿æ•´è¡Œç‚ºã€‚

### 6. è¡Œç‚ºæ¨¡å¼æª¢æ¸¬
```go
When(agent.WhenFunc("retry_attempt", func(session agent.Session) bool {
    messages := session.Messages()
    retryCount := 0
    for _, msg := range messages {
        if strings.Contains(strings.ToLower(msg.Content), "try again") {
            retryCount++
        }
    }
    return retryCount >= 2
})).Ask("æˆ‘çœ‹åˆ°æ‚¨å·²ç¶“é‡è©¦äº†å¹¾æ¬¡ã€‚è®“æˆ‘æä¾›é¡å¤–çš„æŒ‡å°ï¼").Build().
```
æª¢æ¸¬è¤‡é›œçš„è¡Œç‚ºæ¨¡å¼ä¸¦ä»¥åŒç†å¿ƒå›æ‡‰ã€‚

## ğŸ› ï¸ å‡½æ•¸å¼å·¥å…·

### è³‡è¨Šæ”¶é›†å·¥å…·
```go
collectTool := agent.NewTool("collect_info", 
    "æ”¶é›†å’Œé©—è­‰ç”¨æˆ¶è³‡è¨Š",
    func(field, value string) map[string]any {
        // è‡ªå‹•é©—è­‰é‚è¼¯
        valid := len(value) > 0
        if field == "email" {
            valid = strings.Contains(value, "@")
        }
        if field == "phone" {
            valid = len(value) >= 10
        }
        
        return map[string]any{
            "field":     field,
            "value":     value,
            "is_valid":  valid,
            "timestamp": time.Now().Format(time.RFC3339),
        }
    })
```

### æª”æ¡ˆé©—è­‰å·¥å…·
```go
validateTool := agent.NewTool("validate_profile",
    "æª¢æŸ¥ç”¨æˆ¶æª”æ¡ˆæ˜¯å¦å®Œæ•´",
    func(userData map[string]any) map[string]any {
        required := []string{"name", "email", "phone", "preferences"}
        missing := []string{}
        
        for _, field := range required {
            if value, exists := userData[field]; !exists || value == "" {
                missing = append(missing, field)
            }
        }
        
        return map[string]any{
            "is_complete":   len(missing) == 0,
            "missing_fields": missing,
            "completion_rate": float64(len(required)-len(missing))/float64(len(required)),
        }
    })
```

## ğŸ“Š çµæ§‹åŒ–è¼¸å‡º

ä»£ç†ç”¢ç”Ÿå®Œæ•´çš„ `UserProfile` çµæ§‹ä½œç‚º JSON è¼¸å‡ºï¼š

```go
type UserProfile struct {
    Name         string   `json:"name"`
    Email        string   `json:"email"`
    Phone        string   `json:"phone"`
    Preferences  []string `json:"preferences"`
    CompletedAt  string   `json:"completed_at,omitempty"`
    IsComplete   bool     `json:"is_complete"`
    MissingInfo  []string `json:"missing_info,omitempty"`
    StatusText   string   `json:"status_text"`
}
```

## ğŸš€ åŸ·è¡Œç¯„ä¾‹

### å‰ç½®éœ€æ±‚
1. Go 1.22 æˆ–æ›´é«˜ç‰ˆæœ¬
2. OpenAI API é‡‘é‘°

### è¨­å®š
```bash
# 1. é…ç½®æ‚¨çš„ API é‡‘é‘°
cp .env.example .env
# ç·¨è¼¯ .env ä¸¦æ·»åŠ æ‚¨çš„ OPENAI_API_KEY

# 2. åŸ·è¡Œç¯„ä¾‹
cd examples/advanced-conditions
go run main.go
```

## ğŸ“‹ æ¸¬è©¦å ´æ™¯

ç¯„ä¾‹åŸ·è¡Œå…¨é¢çš„æ¸¬è©¦å ´æ™¯ï¼š

1. **åˆå§‹è¯çµ¡** - è§¸ç™¼å§“åæ”¶é›†æ¢ä»¶
2. **æ±‚åŠ©è«‹æ±‚** - å±•ç¤ºåŸºæ–¼å…§å®¹çš„æ¢ä»¶  
3. **è³‡è¨Šæ”¶é›†** - é¡¯ç¤ºæ¼¸é€²å¼æ¬„ä½æ”¶é›†
4. **è·³éå˜—è©¦** - å„ªé›…è™•ç†ç”¨æˆ¶æŠ—æ‹’
5. **æŒ«æŠ˜æª¢æ¸¬** - å›æ‡‰ç”¨æˆ¶å›°é›£
6. **å®Œæˆè¿½è¹¤** - ç”¢ç”Ÿçµæ§‹åŒ–è¼¸å‡º

### ç¯„ä¾‹è¼¸å‡º
```
ğŸ¯ é€²éšæ¢ä»¶ç¯„ä¾‹
å±•ç¤ºå„ªé›…çš„æ¢ä»¶ä½¿ç”¨å’Œæµç¨‹æ§åˆ¶
============================================================

ğŸš€ æ¸¬è©¦é€²éšæ¢ä»¶ç³»çµ±
============================================================

ğŸ”„ æ¸¬è©¦ 1/8: åˆå§‹è¯çµ¡ - æ‡‰è§¸ç™¼ç¼ºå°‘å§“åæ¢ä»¶
ğŸ‘¤ ç”¨æˆ¶: å—¨ï¼æˆ‘æƒ³è¨»å†Šã€‚
ğŸ¤– åŠ©æ‰‹: æ‚¨å¥½ï¼æˆ‘å¾ˆæ¨‚æ„å¹«åŠ©æ‚¨é–‹å§‹ã€‚è«‹å•æ‚¨çš„å§“åæ˜¯ï¼Ÿ

ğŸ”„ æ¸¬è©¦ 2/8: æä¾›å§“å - æ‡‰è©¢å•é›»å­éƒµä»¶
ğŸ‘¤ ç”¨æˆ¶: æˆ‘çš„åå­—æ˜¯ Alex Chen
ğŸ¤– åŠ©æ‰‹: å¾ˆå¥½ï¼ç¾åœ¨æˆ‘éœ€è¦æ‚¨çš„é›»å­éƒµä»¶åœ°å€ä¾†è¨­å®šå¸³æˆ¶ã€‚

ğŸ”„ æ¸¬è©¦ 3/8: åŒ…å« 'help' - æ‡‰è§¸ç™¼å¹«åŠ©æ¢ä»¶
ğŸ‘¤ ç”¨æˆ¶: æ‚¨èƒ½å¹«æˆ‘äº†è§£éœ€è¦ä»€éº¼è³‡è¨Šå—ï¼Ÿ
ğŸ¤– åŠ©æ‰‹: ç•¶ç„¶ï¼æˆ‘åœ¨é€™è£¡å¹«åŠ©æ‚¨å®Œæˆæª”æ¡ˆã€‚æ‚¨éœ€è¦ä»€éº¼ç‰¹å®šè³‡è¨Šçš„å”åŠ©ï¼Ÿ

ğŸ“Š æª”æ¡ˆç‹€æ…‹: å®Œæˆ=falseï¼Œç¼ºå¤±=[email, phone, preferences]
ğŸ“ˆ æœƒè©±è¨Šæ¯: 6

ğŸ‰ æª”æ¡ˆæˆåŠŸå®Œæˆï¼
```

## ğŸ“ æ¢ä»¶é¡å‹åƒè€ƒ

| æ¢ä»¶é¡å‹ | èªæ³• | ä½¿ç”¨å ´æ™¯ | ç¯„ä¾‹ |
|----------|------|---------|------|
| **æ¬„ä½æ¢ä»¶** | `OnMissingInfo("field")` | å¿…å¡«æ¬„ä½æ”¶é›† | ç¼ºå¤±é›»å­éƒµä»¶/é›»è©± |
| **è¨Šæ¯è¨ˆæ•¸** | `OnMessageCount(n)` | å°è©±ç®¡ç† | é•·å°è©± |
| **å…§å®¹æª¢æ¸¬** | `WhenContains("text")` | é—œéµå­—å›æ‡‰ | æ±‚åŠ©è«‹æ±‚ |
| **è‡ªè¨‚å‡½æ•¸** | `WhenFunc("name", fn)` | è¤‡é›œé‚è¼¯ | ç‡Ÿæ¥­æ™‚é–“ |
| **é‚è¼¯ AND** | `And(cond1, cond2)` | å¤šé‡éœ€æ±‚ | é›»å­éƒµä»¶ AND é›»è©± |
| **é‚è¼¯ OR** | `Or(cond1, cond2)` | æ›¿ä»£è§¸ç™¼å™¨ | æŒ«æŠ˜ OR å›°é›£ |
| **é‚è¼¯ NOT** | `Not(condition)` | å¦å®šé‚è¼¯ | éé€±æœ«æœŸé–“ |

## ğŸ† ä¸»è¦å­¸ç¿’ç›®æ¨™

å­¸ç¿’æ­¤ç¯„ä¾‹å¾Œï¼Œæ‚¨æ‡‰è©²äº†è§£ï¼š

1. **æ¼¸é€²æ¢ä»¶è¤‡é›œåº¦** - å¾ç°¡å–®åˆ°è¤‡é›œçš„å»ºæ§‹
2. **å„ªé›…èªæ³•è¨­è¨ˆ** - å¯è®€ã€å¯ç¶­è­·çš„æ¢ä»¶å®šç¾©
3. **è¡Œç‚ºæ™ºèƒ½** - å‰µå»ºå…·æœ‰æƒ…ç·’æ„ŸçŸ¥çš„å°è©±ä»£ç†
4. **å·¥å…·æ•´åˆ** - çµåˆæ¢ä»¶èˆ‡å‡½æ•¸å¼å·¥å…·
5. **çµæ§‹åŒ–è¼¸å‡º** - ç®¡ç†è¤‡é›œçš„è³‡æ–™æ”¶é›†å·¥ä½œæµç¨‹
6. **æ™‚é–“æ„ŸçŸ¥è¡Œç‚º** - å‰µå»ºæƒ…å¢ƒæ•æ„Ÿçš„å›æ‡‰
7. **æ¨¡å¼è­˜åˆ¥** - æª¢æ¸¬å’Œå›æ‡‰ç”¨æˆ¶è¡Œç‚ºæ¨¡å¼

## ğŸ”„ å‰å¾Œå°æ¯”ï¼šæ¢ä»¶ç³»çµ±

### å‚³çµ±æ–¹æ³•ï¼ˆè¤‡é›œä¸”å†—é•·ï¼‰
```go
// æ‰‹å‹•æ¢ä»¶æª¢æŸ¥
if len(session.Messages()) > 5 {
    if containsKeyword(lastMessage, "help") {
        if isBusinessHours() && userSeemsFrustrated(session) {
            // è¤‡é›œçš„åµŒå¥—é‚è¼¯...
        }
    }
}
```

### go-agent æ–¹æ³•ï¼ˆå„ªé›…ä¸”å¯è®€ï¼‰
```go
// å®£å‘Šå¼æ¢ä»¶ç³»çµ±
When(agent.And(
    agent.WhenMessageCount(5),
    agent.WhenContains("help"),
    agent.WhenFunc("business_hours", isBusinessHours),
    agent.WhenFunc("frustrated", detectFrustration),
)).Ask("è®“æˆ‘æä¾›å³æ™‚å”åŠ©ï¼").Build()
```

## ğŸ¯ å±•ç¤ºçš„æœ€ä½³å¯¦è¸

1. **å¾ç°¡å–®é–‹å§‹** - å¾åŸºæœ¬æ¬„ä½æ¢ä»¶é–‹å§‹ï¼Œé€æ­¥å¢åŠ è¤‡é›œåº¦
2. **æ·±æ€ç†Ÿæ…®åœ°çµ„åˆ** - ä½¿ç”¨ AND/OR å‰µå»ºæœ‰æ„ç¾©çš„æ¢ä»¶çµ„åˆ  
3. **è™•ç†é‚Šç·£æƒ…æ³** - åŒ…å«å¸¸è¦‹ç”¨æˆ¶è¡Œç‚ºçš„æ¢ä»¶ï¼ˆå¹«åŠ©ã€è·³éã€æŒ«æŠ˜ï¼‰
4. **ç¶­æŒå¯è®€æ€§** - ç‚ºè‡ªè¨‚æ¢ä»¶ä½¿ç”¨æè¿°æ€§åç¨±
5. **å¾¹åº•æ¸¬è©¦** - é©—è­‰æ¢ä»¶åœ¨é æœŸå ´æ™¯ä¸­è§¸ç™¼
6. **æ¼¸é€²å¢å¼·** - å¾ç°¡å–®åˆ°è¤‡é›œçš„æ¢ä»¶å±¤ç´š

## ğŸ”„ ä¸‹ä¸€æ­¥

æŒæ¡æ­¤ç¯„ä¾‹å¾Œï¼š
1. **[å¤šå·¥å…·ä»£ç†](../multi-tool-agent/)** - å”èª¿å¤šç¨®èƒ½åŠ›
2. **[ä»»å‹™å®Œæˆ](../task-completion/)** - é€²éšçµæ§‹åŒ–è¼¸å‡ºè™•ç†
3. **è‡ªè¨‚æ¢ä»¶** - å‰µå»ºæ‚¨è‡ªå·±çš„æ¢ä»¶é¡å‹
4. **æ•´åˆæ¨¡å¼** - èˆ‡å¤–éƒ¨ç³»çµ±çµåˆ

## ğŸ› å¸¸è¦‹æ¨¡å¼èˆ‡è§£æ±ºæ–¹æ¡ˆ

### æ¨¡å¼ï¼šæ¼¸é€²å¼è³‡è¨Šæ”¶é›†
```go
OnMissingInfo("name").Ask("æ‚¨çš„å§“åæ˜¯ä»€éº¼ï¼Ÿ").Build().
OnMissingInfo("email").Ask("æ‚¨çš„é›»å­éƒµä»¶æ˜¯ä»€éº¼ï¼Ÿ").Build().
```

### æ¨¡å¼ï¼šæŒ«æŠ˜æª¢æ¸¬èˆ‡å›æ‡‰
```go
When(agent.Or(
    agent.WhenContains("frustrated"),
    agent.WhenMessageCount(8),
)).Ask("è®“æˆ‘å¹«æ‚¨ç°¡åŒ–é€™å€‹æµç¨‹ï¼").Build().
```

### æ¨¡å¼ï¼šæ™‚é–“æ„ŸçŸ¥è¡Œç‚º
```go
When(agent.WhenFunc("after_hours", func(session agent.Session) bool {
    return time.Now().Hour() > 17
})).Ask("æˆ‘ 24/7 éƒ½åœ¨é€™è£¡å¹«åŠ©æ‚¨ï¼").Build().
```

## ğŸ’¡ å±•ç¤ºçš„é—œéµ API

### æ¢ä»¶å‰µå»º
- `OnMissingInfo(fields...)` - æ¬„ä½æ¢ä»¶
- `OnMessageCount(n)` - è¨Šæ¯æ•¸é‡é–¾å€¼
- `WhenContains(text)` - å…§å®¹æª¢æ¸¬
- `WhenFunc(name, fn)` - è‡ªè¨‚å‡½æ•¸æ¢ä»¶

### é‚è¼¯é‹ç®—å­
- `agent.And(conditions...)` - æ‰€æœ‰æ¢ä»¶å¿…é ˆç‚ºçœŸ
- `agent.Or(conditions...)` - ä»»ä¸€æ¢ä»¶å¿…é ˆç‚ºçœŸ  
- `agent.Not(condition)` - å¦å®šæ¢ä»¶

### æµç¨‹å‹•ä½œ
- `.Ask(message)` - ç”¨ç‰¹å®šè¨Šæ¯æç¤ºç”¨æˆ¶
- `.Summarize()` - è«‹æ±‚å°è©±æ‘˜è¦
- `.UseTemplate(template)` - æ‡‰ç”¨å‹•æ…‹æŒ‡ä»¤

æ­¤ç¯„ä¾‹å±•ç¤ºäº† go-agent çš„æ¢ä»¶ç³»çµ±å¦‚ä½•è®“æ‚¨å‰µå»º**æ™ºèƒ½ã€é©æ‡‰æ€§å’Œå¯Œæœ‰åŒç†å¿ƒ**çš„å°è©±ä»£ç†ï¼ŒåŒæ™‚ä¿æŒ**å„ªé›…ã€å¯ç¶­è­·çš„ç¨‹å¼ç¢¼**ã€‚